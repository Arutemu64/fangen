~~~
███████╗ █████╗ ███╗   ██╗ ██████╗ ███████╗███╗   ██╗
██╔════╝██╔══██╗████╗  ██║██╔════╝ ██╔════╝████╗  ██║
█████╗  ███████║██╔██╗ ██║██║  ███╗█████╗  ██╔██╗ ██║
██╔══╝  ██╔══██║██║╚██╗██║██║   ██║██╔══╝  ██║╚██╗██║
██║     ██║  ██║██║ ╚████║╚██████╔╝███████╗██║ ╚████║
╚═╝     ╚═╝  ╚═╝╚═╝  ╚═══╝ ╚═════╝ ╚══════╝╚═╝  ╚═══
~~~

# FANGEN

Небольшой набор инструментов для автоматизации подготовки к Нижегодскому фестивалю анимации и фантастики FANFAN.
Inspired by [Cosplay2-Automation](https://github.com/Himura2la/Cosplay2-Automation)

## Установка

* Скачать последний релиз из раздела Releases, распаковать.
* * Или самостоятельно скачать исходники, создать venv, установить зависимости (через [uv](https://docs.astral.sh/uv/)).
* Переименовать config.dist.toml в config.toml и заполнить актуальными данными (почта/пароль от Cosplay2, ID события).
* Читать дальше.

## Использование

Открыть терминал в каталоге со скриптом
~~~
.\fangen.exe [опции] команда [аргументы]
~~~

## Доступные опции

* **config** 
    
    Путь к конфигу
    
    Необязательно, по умолчанию - config.toml в текущем каталоге.

## Доступные команды

### make_db

Скачивает расписание и данные из всех заявок с Cosplay2 и сохраняет в локальной базе данных.

### make_data

Создает Excel-файл, содержащий данные из всех заявок. Каждый раздел на отдельном листе.

#### Доступные аргументы:

* **filepath**

    Путь к Excel-файлу, который будет заполняться. 
    
    Необязательно, по умолчанию - excel.xlsx в текущем каталоге. 
    
    Если файл не существует - он будет создан.

### make_plan

Заполняет листы Excel файла на основе заголовков в первой строке данными из заявок Cosplay2 в порядке расписания.

#### Доступные аргументы:

* **filepath**

    Путь к Excel-файлу, который будет заполняться. 
    
    Необязательно, по умолчанию - plan.xlsx в текущем каталоге. 
    
    Если файл не существует - он будет создан.

#### Особенности работы:

* **При каждом запуске файл стирается и заполняется с нуля!**
* В первую строку вписываются заголовки. Они работают как шаблоны карточек в Cosplay2 - это означает, что заголовок {Ваши данные|Ваш никнейм} подставит одно из полей заявки в клетку. Это удобно, если одинаковые по смыслу поля могут называться по разному в разных разделах.
    Например:

    > {ФИО} из {Город}

    Наполнит каждую строку в столбике Excel-файла следующим образом:

    > Иванов Иван Иванович из Нижний Новгород

* Если в заявке несколько полей с одним названием они будут представлены массивом. Например заголовок:

    > {Персонаж}

    Может наполнить клетку следующим образом:

    > ['Аль-Хайтам', 'Дори', 'Дэхья', 'Кавех', 'Кандакия', 'Коллеи', 'Лайла', 'Нахида', 'Нилу', 'Сайно', 'Странник', 'Тигнари']

* Файл dictionary.json содержит словарь для преобразования человекочитаемых названий во внутренние переменные. Советую открыть файл через текстовый редактор и ознакомиться, какие поля доступны. Так станет понятнее.
* Поле {info} (или {Инфо} согласно словарю) содержит общую информацию о разделе или заявке.
* * Для события - название события
* * Для раздела - название раздела
* * Для заявки - название заявки и ссылка на неё
* Поле {n} (или N, №, Номер согласно словарю) создает нумерацию для заявок (пропускает события).